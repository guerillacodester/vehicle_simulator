{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Passenger Analytics Model Schema",
  "description": "Schema for defining passenger rate and count models at specific locations",
  "type": "object",
  "required": ["model_info", "locations", "time_patterns", "demand_profiles"],
  
  "properties": {
    "model_info": {
      "type": "object",
      "required": ["name", "version", "description"],
      "properties": {
        "name": { "type": "string", "description": "Model name" },
        "version": { "type": "string", "pattern": "^\\d+\\.\\d+\\.\\d+$" },
        "description": { "type": "string" },
        "author": { "type": "string" },
        "created_date": { "type": "string", "format": "date-time" },
        "updated_date": { "type": "string", "format": "date-time" },
        "data_source": { "type": "string", "description": "Source of passenger data" },
        "coverage_area": {
          "type": "object",
          "properties": {
            "city": { "type": "string" },
            "region": { "type": "string" },
            "country": { "type": "string" },
            "bbox": {
              "type": "array",
              "items": { "type": "number" },
              "minItems": 4,
              "maxItems": 4,
              "description": "[min_lat, min_lon, max_lat, max_lon]"
            }
          }
        }
      }
    },
    
    "locations": {
      "type": "object",
      "description": "Location-specific passenger parameters",
      "patternProperties": {
        "^[a-zA-Z0-9_-]+$": {
          "type": "object",
          "required": ["coordinates", "type", "passenger_rates"],
          "properties": {
            "name": { "type": "string" },
            "coordinates": {
              "type": "object",
              "required": ["latitude", "longitude"],
              "properties": {
                "latitude": { "type": "number", "minimum": -90, "maximum": 90 },
                "longitude": { "type": "number", "minimum": -180, "maximum": 180 },
                "elevation": { "type": "number", "description": "Meters above sea level" }
              }
            },
            "type": { 
              "type": "string", 
              "enum": ["depot", "bus_stop", "train_station", "terminal", "interchange", "park_and_ride"]
            },
            "capacity": {
              "type": "object",
              "properties": {
                "waiting_area": { "type": "integer", "minimum": 0 },
                "shelter_capacity": { "type": "integer", "minimum": 0 },
                "parking_spaces": { "type": "integer", "minimum": 0 }
              }
            },
            "amenities": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Available amenities at location"
            },
            "accessibility": {
              "type": "object",
              "properties": {
                "wheelchair_accessible": { "type": "boolean" },
                "audio_announcements": { "type": "boolean" },
                "visual_displays": { "type": "boolean" },
                "tactile_guidance": { "type": "boolean" }
              }
            },
            "passenger_rates": {
              "type": "object",
              "required": ["boarding", "alighting"],
              "properties": {
                "boarding": {
                  "type": "object",
                  "required": ["peak_hours", "off_peak_hours"],
                  "properties": {
                    "peak_hours": {
                      "type": "object",
                      "required": ["rate_per_hour", "variance"],
                      "properties": {
                        "rate_per_hour": { "type": "number", "minimum": 0 },
                        "variance": { "type": "number", "minimum": 0, "maximum": 1 },
                        "confidence_level": { "type": "number", "minimum": 0, "maximum": 1, "default": 0.8 }
                      }
                    },
                    "off_peak_hours": {
                      "type": "object",
                      "required": ["rate_per_hour", "variance"],
                      "properties": {
                        "rate_per_hour": { "type": "number", "minimum": 0 },
                        "variance": { "type": "number", "minimum": 0, "maximum": 1 },
                        "confidence_level": { "type": "number", "minimum": 0, "maximum": 1, "default": 0.8 }
                      }
                    }
                  }
                },
                "alighting": {
                  "type": "object",
                  "required": ["peak_hours", "off_peak_hours"],
                  "properties": {
                    "peak_hours": {
                      "type": "object",
                      "required": ["rate_per_hour", "variance"],
                      "properties": {
                        "rate_per_hour": { "type": "number", "minimum": 0 },
                        "variance": { "type": "number", "minimum": 0, "maximum": 1 },
                        "confidence_level": { "type": "number", "minimum": 0, "maximum": 1, "default": 0.8 }
                      }
                    },
                    "off_peak_hours": {
                      "type": "object",
                      "required": ["rate_per_hour", "variance"],
                      "properties": {
                        "rate_per_hour": { "type": "number", "minimum": 0 },
                        "variance": { "type": "number", "minimum": 0, "maximum": 1 },
                        "confidence_level": { "type": "number", "minimum": 0, "maximum": 1, "default": 0.8 }
                      }
                    }
                  }
                },
                "average_wait_time": {
                  "type": "object",
                  "properties": {
                    "peak_minutes": { "type": "number", "minimum": 0 },
                    "off_peak_minutes": { "type": "number", "minimum": 0 }
                  }
                }
              }
            },
            "seasonal_factors": {
              "type": "object",
              "properties": {
                "spring": { "type": "number", "minimum": 0, "default": 1.0 },
                "summer": { "type": "number", "minimum": 0, "default": 1.0 },
                "autumn": { "type": "number", "minimum": 0, "default": 1.0 },
                "winter": { "type": "number", "minimum": 0, "default": 1.0 }
              }
            },
            "special_events": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": { "type": "string" },
                  "multiplier": { "type": "number", "minimum": 0 },
                  "date_pattern": { "type": "string", "description": "Cron-like pattern or specific dates" },
                  "duration_hours": { "type": "number", "minimum": 0 }
                }
              }
            }
          }
        }
      }
    },
    
    "time_patterns": {
      "type": "object",
      "description": "Time-based passenger flow patterns",
      "properties": {
        "peak_hours": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["start_time", "end_time", "multiplier"],
            "properties": {
              "name": { "type": "string" },
              "start_time": { "type": "string", "pattern": "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$" },
              "end_time": { "type": "string", "pattern": "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$" },
              "multiplier": { "type": "number", "minimum": 0 },
              "days_of_week": {
                "type": "array",
                "items": { "type": "string", "enum": ["monday", "tuesday", "wednesday", "thursday", "friday", "saturday", "sunday"] }
              }
            }
          }
        },
        "day_types": {
          "type": "object",
          "properties": {
            "weekday": { "type": "number", "minimum": 0, "default": 1.0 },
            "saturday": { "type": "number", "minimum": 0, "default": 0.7 },
            "sunday": { "type": "number", "minimum": 0, "default": 0.5 },
            "holiday": { "type": "number", "minimum": 0, "default": 0.3 }
          }
        }
      }
    },
    
    "demand_profiles": {
      "type": "object",
      "description": "Passenger demand profiles by trip purpose",
      "properties": {
        "commute": {
          "type": "object",
          "properties": {
            "percentage": { "type": "number", "minimum": 0, "maximum": 100 },
            "peak_preference": { "type": "boolean", "default": true },
            "average_trip_distance": { "type": "number", "minimum": 0 },
            "preferred_routes": { "type": "array", "items": { "type": "string" } }
          }
        },
        "leisure": {
          "type": "object",
          "properties": {
            "percentage": { "type": "number", "minimum": 0, "maximum": 100 },
            "peak_preference": { "type": "boolean", "default": false },
            "average_trip_distance": { "type": "number", "minimum": 0 },
            "preferred_routes": { "type": "array", "items": { "type": "string" } }
          }
        },
        "shopping": {
          "type": "object",
          "properties": {
            "percentage": { "type": "number", "minimum": 0, "maximum": 100 },
            "peak_preference": { "type": "boolean", "default": false },
            "average_trip_distance": { "type": "number", "minimum": 0 },
            "preferred_routes": { "type": "array", "items": { "type": "string" } }
          }
        },
        "education": {
          "type": "object",
          "properties": {
            "percentage": { "type": "number", "minimum": 0, "maximum": 100 },
            "peak_preference": { "type": "boolean", "default": true },
            "average_trip_distance": { "type": "number", "minimum": 0 },
            "preferred_routes": { "type": "array", "items": { "type": "string" } }
          }
        }
      }
    },
    
    "real_time_adjustments": {
      "type": "object",
      "description": "Real-time adjustment parameters",
      "properties": {
        "weather_impact": {
          "type": "object",
          "properties": {
            "rain": { "type": "number", "default": 1.2 },
            "snow": { "type": "number", "default": 0.8 },
            "extreme_heat": { "type": "number", "default": 0.9 },
            "extreme_cold": { "type": "number", "default": 0.9 }
          }
        },
        "service_disruptions": {
          "type": "object",
          "properties": {
            "delay_multiplier": { "type": "number", "default": 1.3 },
            "cancellation_redistribution": { "type": "number", "default": 1.5 }
          }
        }
      }
    },
    
    "model_parameters": {
      "type": "object",
      "description": "Global model parameters",
      "properties": {
        "simulation_step_minutes": { "type": "integer", "minimum": 1, "default": 5 },
        "passenger_patience_minutes": { "type": "number", "minimum": 0, "default": 15 },
        "group_formation_probability": { "type": "number", "minimum": 0, "maximum": 1, "default": 0.3 },
        "walking_speed_ms": { "type": "number", "minimum": 0, "default": 1.4 },
        "boarding_time_seconds": { "type": "number", "minimum": 0, "default": 3 },
        "alighting_time_seconds": { "type": "number", "minimum": 0, "default": 2 }
      }
    }
  }
}